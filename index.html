<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>123, it's easy as ABC</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/beige.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section data-timing=15>

					<h1>
						Constructing an action potential model: it's easy as ABC?
					</h1>
					<br/>
					<p>
						Charles Houston (<a href="mailto:cph211@ic.ac.uk">cph211@ic.ac.uk</a>)<br />
						MRes Biomedical Research<br /><br />
						4 Sep 2017
					</p>

					<aside class="notes">
						Good afternoon.
						The title of my presentation is ...
						This was an entirely computational project based on developing a mathematical description for the action potential of a cardiac myocyte.
						I'm going to lead the presentation with the motivation behind this project, which I think is useful to frame the work within the overall goal of my PhD.
					</aside>

				</section>

				<section data-timing=15 data-background-transition="slide" data-background-color="#000000">
					<video width=65% loop data-autoplay>
						<source data-src="img/cardiac-model.mp4" />
					</video>
					<aside class="notes">
						Computational modelling of cardiac systems has become an important tool to generate and test hypotheses that may be difficult or impossible to test in a biological or clinical setting.
						This video is an example of a simulation of fibrillation in a human atria.
						A commonality between the majority of modern models is their use of homogenised approaches where the tissue is modelled as a continuous medium.
						However, by their nature these simulations do not account for cell-level propagation between individual myocytes...
					</aside>
				</section>
				
				<section data-timing=15 data-background-color="#000000" data-background-transition="slide">
					<video width=65% loop data-autoplay>
						<source data-src="img/cdt.mp4" />
					</video>
					
					<aside class="notes">
						This is a recording of a reentrant circuit in a monolayer of myocytes showing the feature which may drive the arrhythmia at the macro-scale is affected by microscopic mechanisms.
					</aside>
				</section>

				<section data-timing=30 data-background-transition="slide">
					<h2>Towards a discrete-cell modelling framework</h2>
					<ul>
						<li>Discrete-cell simulations account for propagation between individual myocytes...</li>
						<li>...but difficult to validate with biological experiments.</li>
						<li>HL1-6 subclone have slow conduction velocity which enables validation through optical mapping.</li>
						<li>First step to discrete-cell model is to construct a mathematical model of action potential of a single cell.</li>
					</ul>

					<aside class="notes">
						Discrete-cell models are an alternative to homogenised models, where cells are modelled as separate, connected regions in the simulation.
						A major difficulty with developing these models is validating them with experimental data.
						In our lab, we have a cell line, HL1-6, which have slow conduction velocity so can be used to develop a morphologically accurate, biophysically-validated discrete-cell framework for future modelling.
						This is the goal of my PhD work. Before this can be completed we require a mathematical model of the action potential of a single HL1-6 myocyte.
					</aside>
				</section>

				<section data=timing=30>
					<h2>Modelling an action potential</h2>
					<img style="border:none; background-color:white" class="stretch" data-src="img/equations.svg">
					<ul>					
						<li>Fit to experimental patch clamp data using traditional methods which do not account for uncertainty in estimates.</li>
						<li>Approximate Bayesian Computation (ABC) produces distribution of parameter estimates.</li>
					</ul>

					<aside class="notes">
						How is action potential modelled in a single cell?
						The flow of ions through transmembrane channels is described by an equation with 'gating' variables.
						Underlying these gating variables are systems of ODEs, which are themselves composed of variables describing the steady-state and time constants.
						Parameters in equations are then determined by fitting to data from patch clamp experiments. 
						Standard practice is to use point estimation methods to set the parameter values. 
						Unfortunately, these ignore uncertainties around estimates, which has been shown to lead to discrepancies between models.
						Approximate Bayesian Computation is an inference approach from machine learning that is used to obtain posterior distributions for parameters, allowing investigation of uncertainty and identifiability.
					</aside>
				</section>

				<section data-timing=20>
					<h2>Hypothesis</h2>
					<blockquote style="width: 80%; text-align: left">
						The <span class="fragment highlight-red" data-fragment-index="1">ABC approach</span> can be used to construct a <span class="fragment highlight-blue" data-fragment-index="1">validated mathematical model</span> of the action potential of a HL1-6 cell while taking into account <span class="fragment highlight-green" data-fragment-index="1">uncertainties in parameter estimates</span> arising from insufficient fitting data, biological variability and/or parameter redundancy.
					</blockquote>

					<aside class="notes">
						This leads to the hypothesis of this project: state hypothesis.
						There are three main parts of this hypothesis: the ABC method, parameter uncertainties and the validated mathematical model.
						These constitute the three main aims of the project.
					</aside>
				</section>

				<section data-timing=20>
					<h2 >Aims</h2>
					<ol>
						<li style="color:rgb(243,84,38);font-weight:bold;"><span style="color:black;font-weight:normal;">Develop an ABC implementation to estimate parameter posterior distributions for individual ion currents.</span></li>
						<li style="color:rgb(117,171,31);font-weight:bold;"><span style="color:black;font-weight:normal">Investigate sources of uncertainty and unidentifiability in parameter estimates.</span></li>
						<li style="color:rgb(27,163,238);font-weight:bold;"><span style="color:black;font-weight:normal">Construct the full action potential model and validate with experimental data.</span></li>
					</ol>
				</section>

				<section data-timing=45>
					<h2>Approximate Bayesian Computation (ABC)</h2>
					<img style="border:none; box-shadow:none;" class="stretch" data-src="img/abc-smc.svg">

					<aside class="notes">
						Its useful to briefly explain how the ABC method generates its distributions over parameters rather than traditional points estimates to understand the following results.
						So firstly, we have some experimental data from the specific current we are modelling, and a method to simulate that current using the formulation of ODEs in our computer model.
						The essential idea is that for each parameter in the equations, we set a range of possible values governed by a simple uniform distribution.
						We then randomly draw values from that prior and simulate using the model.
						We only accept simulations that are close to experimental data.
						This allows us to build up a posterior distribution of the likely values for each parameter.
						In the specific implementation I use, this posterior is then used as the prior for in multiple iterations of this process for computational tractability.
						In practice, this posterior distribution is a discrete approximation given by a number of 'particles'.
					</aside>

				</section>

				<!-- <section data-timing=20>
					<h3>Model Overview</h3>
					<p>
						Simulate by solving 35 ODEs at each time step.
					</p>
					<img class="stretch" style="border: none; box-shadow: none;" data-src="img/houston_model-2.png">

					<aside class="notes">
						So now I will move on to discuss the final aim of the project which was to construct the full action potential model and validate to experimental data.
						Due to the unidentifiability in the time constants of the currents, ABC was re-run only altering steady-state parameters it could constrain and otherwise retaining values from the original formulations.
						This diagram shows all the currents and exchangers used in the model, of which 6 were fit successfully through ABC. The other currents are either basic linear ohmic currents or no experimental data exists so formulations were retained from a mouse ventricular model.
					</aside>
				</section> -->

				<section>
					<h2 style="color:rgb(243,84,38); text-align:left">Aim 1:</h2>
					<!-- <section data-timing=30>
						<h3>Rapid delayed-rectifier K+ current</h3>
						<img class="stretch" data-src="img/fig_ikr.svg">
						<p><small>A = activation, B = tail current</small></p>


					</section> -->

					<section data-timing=15>
						<h2>T-type calcium current</h2>
						<img class="stretch" data-src="img/fig_icat.svg">
						<p><small>A = activation, B = inactivation, C = recovery</small></p>

						<aside class="notes">
								Addressing the first aim to develop an ABC implementation to estimate parameter distributions, I developed a tool to use input of experimental data from publications and an ion current formulation from previous models and produce output of parameter posterior distributions.
								This graph gives a representative example of output from the process.
								The three graphs show results from the three standard patch clamp protocols used in this fitting - activation, inactivation and recovery.
								Green circles are the published experimental data points, the red dashed line is the original parameter settings for the equations from a model that happened to be fit to the same data, and the blue line and shaded area represent the distribution of results from the ABC posterior.


								<!-- Here are a few examples for different channels identified in HL1-6 myocytes.
								So here are the results for one of the K+ currents in the model.
								Lack of data for this channel specific to our subclone meant we used data for the original HL-1 cell line which should be a close approximation but is indeed a significant limitation of the project.
								We compare the results from ABC, with uncertainties shown by one standard deviation, to the experimental fitting data and the original formulation from a published model also fit to the same data.
								ABC actually improves the fit to the experimental data and appears to have little uncertainty. -->
						</aside>
						<!-- <aside class="notes">
							A slightly different result is given by the T-type calcium current where we also include available recovery patch clamp protocol data.
							In this case, we see again the ABC approach improves the fit on the original formulation,particularly in activation.
							However, we can also note that the formulation appears to struggle to fit the recovery data, indicated by the widening distribution in this plot. 
							The original formulation was not fit to this data at all, and this may indicate the reason why.
						</aside> -->
					</section>

					<section data-timing=15>
						<h2>Fast Na+ current</h2>
						<img class="stretch" data-src="img/fig_ina.svg">
						<p><small>A = activation, B = inactivation</small></p>

						<aside class="notes">
							Finally, this is the fast sodium channel which is a critical component in the action potential.
							There is small uncertainty in the output of the simulation but it appears to struggle to fit to the threshold voltage of the current, which may indicate a deficiency in the formulation itself to model this reduced current.

							From all of these results, it appears from the small distributions in the output that the parameters in the channel equations have been well contrained.
							However, these plots are only looking at the simulation output from a specific experiment, rather than the underlying steady-state and time constant variables in the ODEs themselves which manifest to this behaviour.
						</aside>

					</section>
				</section>

				<section>
					<h2 style="color:rgb(117,171,31); text-align:left">Aim 2:</h2>
					<section data-timing=60>
						<h2>Underlying variables</h2>
						<ul><li>ABC could not constrain time constant curves with standard protocol patch clamp data.</li></ul>
						<img class="stretch" data-src="img/consts_ikur.png">
						<p><small>A = steady-state curves, B = activation time constant curve, C = inactivation time constant curve</small></p>

						<aside class="notes">
							Again, I will only show a representative result here.
							Here are plots of the variation of these steady-state and time constants with voltage, each dashed line represents a single discretised particle from the ABC posterior distribution.
							So we see that steady-state variables appear well constrained by the fitting process, but the temporal variables have wide distribution in both activation and inactivation.
							As standard patch clamp protocols do not test temporal dynamics of the channel, this indicates an unidentifiability in these parameters.
						</aside>
					</section>

					<section data-timing=30>
						<h2>Identifiability analysis</h2>
						<ul>
							<li>Distributions almost unchanged from uniform prior.</li>
							<li>Suggests practical unidentifiability.</li>
						</ul>
						<img class="stretch" data-src="img/cov_ikur.png">
					</section>

					<aside class="notes">
						This is confirmed by looking at the distributions of these time constant parameters.
						While we would expect a peak in the histograms, we see that they retain an approximately uniform distribution and there is little to no correlation between the variables.
						These features all suggest practical unidentifiability, which results from a lack of appropriate fitting data.
						It is instructive to mention here that this unidentifiability does not indicate ABC is an inferior fitting process to standard point estimation techniques, but rather its output includes additional information that can highlight these issues that would otherwise be missed. And is ultimately critical if we are to reproduce faithfully biological observations using these computer models.
				</section>

				


				<section >
					<h2 style="color:rgb(27,163,238); text-align:left">Aim 3:</h2>
					<section data-timing=30>
						<h2>Full action potential model</h2>
						<ul>
							<li>Automaticity in 56% of runs with mean firing rate 4.9Hz (SD=2.0Hz) is comparable to experiments.</li>
						</ul>
						<img class="stretch" data-src="img/fig_APsample.svg">

						<aside class="notes">
							With the posterior distributions of channels, we do not have a single point to choose for each parameter.
							Therefore in each simulation run we randomly draw from the distributions for each parameter. Interestingly, this results in the full range of full cell activity which can exist within the bounds of the uncertainty.
							I ran 200 simulations in total, first for 100s of simulation time to obtain a steady-state and then recorded without stimulation for 5 further seconds. Over half of these runs displayed natural automaticity, which is also present in the HL1-6 cell line.
							The average natural firing rate was quite variable and high at 4.9Hz with a standard deviation of 2Hz meaning that some simulations, such as the one on the right, are unlikely to be physiological.
							However, general qualitative features for a large portion of the simulations was similar to activity in HL1-6 cells.
						</aside>
					</section>



					<section data-timing=30>
						<h2>Uncertainty quantification</h2>
						<img class="stretch" data-src="img/AP-uncert.png">
						<img style="border: none;" width="65%" data-src="img/results-table.png">

						<aside class="notes">
							A significant advantage of ABC is we can propagate the uncerainty in each parameter up to the macro behaviour of the channel.
							These are the results from paced simulations showing the variability between different simulations and the main ion currents in a single paced action potential.
							The quantitative measurements of action potential duration at 90% repolarisation, resting potential, amplitude and overshoot potential were calculated.
							In summary, the overshoot potential and amplitude were comparable with biological experiments. However, the computer model had a more polarised resting potential and reduced APD.
							It is believed that the more polarised resting potential is a result of the inconsistency in the sodium channel fitting, lowering the threshold potential to fire an action potential and thus lowering the voltage at which the model can maintain steady-state.
							The reduced APD could be due to the fact calcium dynamics were unchanged from the original mouse ventricular cell model, and in that work they also noted a reduced APD compared to experiments.
						</aside>
					</section>

				</section>
				<section data-timing=30>
					<h2>Conclusions</h2>
					<ol>
						<li style="color:rgb(243,84,38);font-weight:bold;"><span style="color:black;font-weight:normal;">ABC is an effective approach to infer model parameters while accounting for uncertainties.</span></li>
						<li style="color:rgb(117,171,31);font-weight:bold;"><span style="color:black;font-weight:normal">Standard protocol voltage patch clamp data is not sufficient to completely constrain time constant parameters.</span></li>
						<li style="color:rgb(27,163,238);font-weight:bold;"><span style="color:black;font-weight:normal">The full action potential model reproduces qualitative and quantitative characteristics of the HL1-6 myocyte.</span></li>
					</ol>
					<aside class="notes">
						So, to finish off this presentation, I believe the hypothesis can be partially accepted.
						The first aim was satisfied, in that a ABC implementation was developed to infer model parameter distributions from fitting data.
						The second aim was also satisfied, and showed that time constant parameters in the model could not be effectively constrained by standard voltage clamp protocols.
						Finally, the third aim was partially satisfied, in that the model reproduces some qualitative and quantitative characterisitcs of the HL1-6 myocyte, but futher work is required to fully validate the cell model. This work is already underway.
				</section>


				<section data-timing=10>
					<h2>Acknowledgements</h2>
					<ul>
						<li>Dr Chris Cantwell</li>
						<li>All members of ElectroCardioMaths Programme</li>
						<li>British Heart Foundation</li>
					</ul>

					<br />
					<img width="250px" data-src="img/CoRE-Imperial-Logo.png">

					<!-- <p class="fragment grow"><em>Thank you for listening!</em></p> -->
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				],
				// Display controls in the bottom right corner
				controls: false,

				// Display a presentation progress bar
				progress: true,

				// Set default timing of 2 minutes per slide
				defaultTiming: 120,

				// Display the page number of the current slide
				slideNumber: false,

				// Push each slide change to the browser history
				history: false,

				// Enable keyboard shortcuts for navigation
				keyboard: true,

				// Enable the slide overview mode
				overview: true,

				// Vertical centering of slides
				center: true,

				// Enables touch navigation on devices with touch input
				touch: true,

				// Loop the presentation
				loop: false,

				// Change the presentation direction to be RTL
				rtl: false,

				// Randomizes the order of slides each time the presentation loads
				shuffle: false,

				// Turns fragments on and off globally
				fragments: true,

				// Flags if the presentation is running in an embedded mode,
				// i.e. contained within a limited portion of the screen
				embedded: false,

				// Flags if we should show a help overlay when the questionmark
				// key is pressed
				help: true,

				// Flags if speaker notes should be visible to all viewers
				showNotes: false,

				// Global override for autolaying embedded media (video/audio/iframe)
				// - null: Media will only autoplay if data-autoplay is present
				// - true: All media will autoplay, regardless of individual setting
				// - false: No media will autoplay, regardless of individual setting
				autoPlayMedia: null,

				// Number of milliseconds between automatically proceeding to the
				// next slide, disabled when set to 0, this value can be overwritten
				// by using a data-autoslide attribute on your slides
				autoSlide: 0,

				// Stop auto-sliding after user input
				autoSlideStoppable: true,

				// Use this method for navigation when auto-sliding
				autoSlideMethod: Reveal.navigateNext,

				// Enable slide navigation via mouse wheel
				mouseWheel: false,

				// Hides the address bar on mobile devices
				hideAddressBar: true,

				// Opens links in an iframe preview overlay
				previewLinks: false,

				// Transition style
				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Transition speed
				transitionSpeed: 'default', // default/fast/slow

				// Transition style for full page slide backgrounds
				backgroundTransition: 'fade', // none/fade/slide/convex/concave/zoom

				// Number of slides away from the current that are visible
				viewDistance: 3,

				// Parallax background image
				parallaxBackgroundImage: '', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"

				// Parallax background size
				parallaxBackgroundSize: '', // CSS syntax, e.g. "2100px 900px"

				// Number of pixels to move the parallax background per slide
				// - Calculated automatically unless specified
				// - Set to 0 to disable movement along an axis
				parallaxBackgroundHorizontal: null,
				parallaxBackgroundVertical: null,

				// The display mode that will be used to show slides
				display: 'block',

				// size of presentation
				width: 1200
			});
		</script>
	</body>
</html>
